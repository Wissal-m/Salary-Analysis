# -*- coding: utf-8 -*-
"""Data Analysis : Employees Dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/13aCNO_vllnscoS4JCKja5nUdr3VJNCeh
"""

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

"""# **The Dataset**"""

df = pd.read_csv('Salary Data.csv')
df.head()

"""This is a dataset we found on Kaggle about Employees' Salary, it contains 6 variables : Age of salaries, their gender, education level, job, experience and salary. Our goal is to analyze this dataset and understand the salary distribution."""

df.shape

df.info()

# Null values in each column of df
df.isnull().sum()

df[df.isnull().any(axis=1)]

"""To continue our analysis, we can either delete these two rows or remplace the null values. Since our dataset has only 375 rows (which is not a lot) we decide to replace the null values."""

# Replacing Null values for numerical variables

df['Salary'] = df['Salary'].fillna(df['Salary'].mean())
df['Age'] = df['Age'].fillna(df['Age'].mean())
df['Years of Experience'] = df['Years of Experience'].fillna(df['Years of Experience'].mean())

# For categorical variables

df['Gender'] = df['Gender'].fillna(df['Gender'].value_counts().index[0])
df['Education Level'] = df['Education Level'].fillna(df['Education Level'].value_counts().index[0])
df['Job Title'] = df['Job Title'].fillna(df['Job Title'].value_counts().index[0])

"""Now let's check for null values again"""

df.isnull().sum()

"""No null values"""

# Outliers :
import plotly.express as px

fig = px.histogram(df, x='Years of Experience',marginal='box', nbins = 25, title= '')
fig.update_layout()
fig.show()

"""The last bin (from 24.9 to 25 years of experience) looks like it contains some outliers. Let's check if this is true"""

df.loc[df['Years of Experience'] >= 24]

"""Since these employees are Seniors, and they are +50 years old, we can accept these values (and not consider them as outliers)"""

fig = px.histogram(df, x='Salary',marginal='box', nbins = 25, title= 'Salary Distribution')
fig.update_layout()
fig.show()

df.loc[df['Salary'] >= 250000]

"""We found these two employers in the previous analysis of outliers, so we keep them in the dataset. The goal of keeping these employees is to understand years of experience, job title, and education level affect the salary.

# **Exploratory Data Analysis**
"""

df.describe()

df['Gender'].value_counts()

pd.set_option("display.max_rows", None)
df['Job Title'].value_counts()

df['Education Level'].value_counts()

df[["Years of Experience","Age","Salary"]].groupby(df["Gender"]).mean()

"""We can see here that the average salary for females is ≈
 6.73% less than of males.
"""

df[["Years of Experience","Age","Salary"]].groupby(df["Education Level"]).mean()

"""Average salary increases with the years of studies; employees with a PhD get paid more.   
The average salary for **Bachelor's degree holders is  ≈ 42.23% less** than that for **Master's** degree holders.   
The average salary for **Bachelor's degree holders is  ≈ 52.49% less** than that for **PhD** holders.   
The average salary for **Master's degree holders is  ≈ 17.77% less** than that for **PhD** holders.
"""

fig = px.scatter(df, x='Years of Experience', y ='Salary', color ='Gender', title= 'Salary by Years of Experience', opacity =0.8 )
fig.show()

"""We can clearly see a trend that an increase in years of experience corresponds to a rise in salary.

**The lines of codes below were used to correct a value shown in the scatter plot of 350 salary which was incorrect, and the scatter plot above is after the correction.**
"""

df.loc[df["Salary"] == 350]  #this value is probably an outlier, this is the only employee who gets paid 350, let's check

df.loc[df["Job Title"] == 'Junior Business Operations Analyst']

"""So the salary of the employee in row 259 should be corrected to 35000"""

df.Salary[df.Salary==350.0] = 35000.0

"""We will update the df.desribe() and other codes above."""

fig = px.scatter(df, x='Job Title', y ='Salary', color ='Gender', title= 'Salary by Job Title', opacity =0.8,  width=1000, height=1000 )
fig.show()

"""Some jobs have only Female Employees (Junior Operations Coordinator, .. , HR Manager) and other jobs have predominantly male employees, with a small presence of female employees(Senior Scientist, Sales Manager, Operations Manager..)       
Jobs such as VP of Finance, Director, CEO, Chief Technology Officer, and Chief Data Officer, which have salaries ranging from 200k to 250k, are predominantly held by male employees.
"""

fig = px.histogram(df, x='Job Title', y ='Salary', color ='Gender', title= 'Salary by Job Title', opacity =0.8,  width=1000, height=1000 )
fig.show()

fig = px.histogram(df, x='Education Level', y ='Salary', color ='Gender', title= 'Salary by Education Level', opacity =0.8,  width=1000, height=900 )
fig.show()

df['Education Level'].value_counts()

"""The sum of salary for PhD holders is the smallest while it's the max for Bachelor holders, this without forgetting the fact that employees with PhD are 51 which is only 13.6% of employees.    
If we had the same number of employees with each degree, the total salary of PhD holders would be the highest.
"""

fig = px.scatter(df, x='Age', y ='Salary', color ='Gender', title= 'Salary by Age', opacity =0.8,  width=1000, height=900 )
fig.show()

"""As employees get older, their salaries increase, which is normal since they gain years of experience.   
We can observe a clear trend: as age increases, so does salary

# **Linear Regression**

We will use a simple linear regression to understand how each of the employees' characteristics affects their salary.
"""

matrix = df.corr(numeric_only=True)

sns.heatmap(matrix, cmap='Blues', annot = True)
plt.title('Heat Map')

"""We will only keep Years of Experience for the first model since it is correlated with Age."""

#Salary and Years of Experience
from sklearn.linear_model import LinearRegression

model = LinearRegression()

X = df[['Years of Experience']]
y = df['Salary']

# Fitting the model
model.fit(X, y)

print("Coefficients", model.coef_,"Intercept", model.intercept_)

"""When all other factors are held constant, one additional year of experience is associated with an average increase in salary of 6844.51.    
The intercept of 31921.21 represents the estimated average salary for individuals with zero years of experience.
"""

#Salary and Education Level : but first we need to turn it into a numerical variable
from sklearn.preprocessing import LabelEncoder

label_encoder = LabelEncoder()

#Transform the Education Level column
df['Education_encoded'] = label_encoder.fit_transform(df['Education Level'])

df[['Education_encoded','Education Level']]

from sklearn.linear_model import LinearRegression

model = LinearRegression()

X = df[['Education_encoded']]
y = df['Salary']

# Fitting the model
model.fit(X, y)

print("Coefficients", model.coef_,"Intercept", model.intercept_)

"""This means : **Salary = 76953.57+ 44467.84 * Education Level**    
The coefficient indicates that each step up in education level (from Bachelor's to Master's, and from Master's to PhD) is associated with an **average increase** in salary of **44467.84**.   
The model suggests that higher educational levels are associated with significantly higher salaries.
"""

#Salary with Years of Experience, Gender and Education Level:
label_encoder = LabelEncoder()

#Transform the Education Level column
df['Gender_'] = label_encoder.fit_transform(df['Gender'])

model = LinearRegression()

X = df[['Education_encoded','Years of Experience','Gender_']]
y = df['Salary']

# Fitting the model
model.fit(X, y)

print("Coefficients", model.coef_,"Intercept", model.intercept_)

"""**Salary = 29745.996 + 12717.73 * Education Level + 5995.12 * Years of Experience + 7662.45 * Gender**

- The intercept represents the baseline salary for a female with the lowest level of education and no experience, which is 29745.996.
- The model suggests that each additional level of education increases the salary by approximately 12717.73.
- Each additional year of experience increases the salary by approximately 5995.12.
- Being male is associated with an increase in salary of approximately 7662.45 compared to being female, all else being equal.

**CONCLUSION :**   
The regression model demonstrates that education and experience are significant predictors of salary, with higher levels of both leading to increased earnings. However, the observed gender disparity indicates that other factors may also be influencing salary differences, pointing to the need for continued efforts toward achieving pay equity.

This data analysis project can help recruiters and employers determine the key factors that contribute to salary determination and highlight areas where targeted actions can promote fair and equitable compensation practices.
"""